<ui:composition lang="en" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:f="http://java.sun.com/jsf/core">

  <li>
 		<c:choose>
			<c:when test="#{node.showChildren}">
			    <f:ajax render="treeform">
	    			<h:commandButton image="gfx/minus.png" alt="collapse"
	   					action="#{node.collapse}"/>
				</f:ajax>
    			<h:graphicImage value="/icon?iconId=#{node.iconId}" 
    					alt="#{node.iconId} icon"/>
    			
			    <f:ajax render="treeform detailtab actions">
				    <h:commandLink styleClass="#{node.styleClass}" value="#{node.nodeName}">
						<f:setPropertyActionListener target="#{tree.selectedRefId}" value="#{node.refId}" />			    	
				   	</h:commandLink>
				</f:ajax>
								    
		    	<ul>
					<c:forEach items="#{node.children}" var="node">
			      		<ui:include src="treenode.xhtml"/>
					</c:forEach>
		      	</ul> 
			</c:when>
			<c:otherwise>
	    		<c:if test="#{node.hasChildren}">
				    <f:ajax render="treeform">
		    			<h:commandButton image="gfx/plus.png" alt="expand"
	    					action="#{node.expand}"/>
					</f:ajax>
	    		</c:if>
	    		<h:graphicImage value="/icon?iconId=#{node.iconId}" 
    					alt="#{node.iconId} icon"/>
	    
			    <f:ajax render="treeform detailtab actions">
				    <h:commandLink styleClass="#{node.styleClass}" value="#{node.nodeName}">
						<f:setPropertyActionListener target="#{tree.selectedRefId}" value="#{node.refId}" />			    	
				   	</h:commandLink>
				</f:ajax>
			   	
	    	</c:otherwise>
		</c:choose>
  </li>
 
 </ui:composition>
  
